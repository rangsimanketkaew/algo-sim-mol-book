% LaTeX source for ``Algorithms for Computer Simulation of Molecular Systems''
% Copyright (c) 2023 รังสิมันต์ เกษแก้ว (Rangsiman Ketkaew).

% License: Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)
% https://creativecommons.org/licenses/by-nc-nd/4.0/

\chapter{พลวัตเชิงโมเลกุลแบบดั้งเดิม}
\label{ch:md}

%----------------------------------------
\section{การประยุกต์ใช้ Molecular Dynamics}
%----------------------------------------

ก่อนที่เราจะไปศึกษาวิธีการจำลองระบบโมเลกุลที่มีความซับซ้อนนั้นเราควรเริ่มต้นด้วยการศึกษาวิธีอย่างง่ายก่อนนั่นก็คือ Molecular Dynamics (MD) 
(จริง ๆ จะว่าไปแล้ววิธีนี้ก็ไม่ได้ง่ายนะครับ ถ้าลงรายละเอียดลึก ๆ แล้วก็มีความซับซ้อนมากพอสมควร ซึ่งในปัจจุบันนั้นก็มีการทำวิจัยที่เกี่ยวข้องกับ%
การพัฒนาเทคนิคของวิธี MD อย่างต่อเนื่อง) เราใช้เทคนิคการจำลองทางคอมพิวเตอร์ในการทำความเข้าใจคุณสมบัติของระบบที่ประกอบไปด้วยโมเลกุล 
ๆ โมเลกุลในเชิงโครงสร้างและอันตรกิริยาในระดับจุลภาคหรือหน่วยย่อย ซึ่งหน่วยย่อยในที่นี้ก็คือโมเลกุลนั่นเอง โดยเราสามารถแบ่งวิธีการจำลองออก%
ได้เป็น 2 วิธีคือ Molecular Dynamics (MD) กับ Monte Carlo (MC) และหนังสือเล่มนี้จะเน้นไปที่ MD ซึ่งเป็นวิธีที่สามารถนำมาใช้ในการศึกษา%
คุณสมบัติเชิงพลวัตได้ เช่น สัมประสิทธิ์การเคลื่อนที่ (Transport Coefficients), การตอบสนองต่อการรบกวนแบบที่ขึ้นกับเวลา (Time-dependt 
Response to Perturbation), และสเปกตรัม

ตัวอย่างของคุณสมบัติหรือปรากฏการณ์ที่เราสามารถใช้ MD เพื่อศึกษาได้นั้นมีดังต่อไปนี้

\noindent \textbf{เคมี (Chemistry)}

\begin{itemize}[topsep=0pt,noitemsep]
    \item Intra- and Intermolecular Interactions (Molecular Mechanics)
    \item Chemical Reactions
    \item Phase Transitions
    \item Free Energy Calculations
\end{itemize}

\noindent \textbf{วัสดุศาสตร์ (Materials Science)}

\begin{itemize}[topsep=0pt,noitemsep]
    \item Equilibrium Thermodynamics
    \item Phase Transitions
    \item Properties of Lattice Defects
    \item Nucleation and Surface Growth
    \item Heat/Pressure Processing
    \item Ion Implantation
    \item Properties of Nanostructures
\end{itemize}

\noindent \textbf{ชีวเชิงฟิสิกส์และชีวเคมี (Biophysics and Biochemistry)}

\begin{itemize}[topsep=0pt,noitemsep]
    \item Protein Folding
    \item Protein Structure Prediction
    \item Biocombatibility (Cell Wall Penetration, Chemical Processes)
    \item Molecular Docking
\end{itemize}

\noindent \textbf{การแพทย์ (Medicine)}

\begin{itemize}[topsep=0pt,noitemsep]
    \item Drug Design 
    \item Drug Discovery
\end{itemize}

%----------------------------------------
\section{ประวัติศาสตร์ของ Molecular Dynamics}
%----------------------------------------

\begin{itemize}
    \item 1953: Nicholas Metropolis และคณะได้ตีพิมพ์บทความวิจัยเรื่อง \enquote{Equation of State Calculations by Fast 
    Computing Machines}\autocite{metropolis1953} โดยบทความนี้เป็นเสมือนจุดเริ่มต้นของไอเดีย MD เลยก็ว่าได้ โดยเป็นครั้งแรกที่%
    ได้มีการประยุกต์ใช้เทคนิค Monte Carlo เพื่อแก้สมการที่อธิบายคุณสมบัติเชิงกายภาพของระบบที่ประกอบไปด้วยโมเลกุลที่มีอันตรกิริยาต่อกัน 
    โดยขั้นแรกคือสร้างเซตของตัวเลขสุ่ม (Random Number) เพื่อใช้เป็นตัวแทนของ Conformational Space แล้วก็ใช้ค่าของพลังงานเป็นตัว%
    ระบุความน่าจะเป็นของสถานะของระบบที่ศึกษา
    
    \item 1956: Berni J. Alder และ Thomas E. Wainwright ได้ตีพิมพ์บทความเรื่อง \enquote{Phase Transition for a Hard 
    Sphere System}\autocite{alder1957} ซึ่งถือได้ว่าเป็นงานวิจัยที่เป็นจุดเริ่มต้นของ MD เลยก็ว่าได้
    
    \item 1958: เป็นครั้งแรกที่นักวิทยาศาสตร์ค้นพบโครงสร้างสามมิติของโปรตีนได้โดยใช้เทคนิค X-ray โดยเผยแพร่ในบทความ 
    \enquote{A Three-Dimensional Model of the Myoglobin Molecule Obtained by X-Ray Analysis}\autocite{kendrew1958}

    \item 1964: บทความวิจัยเรื่อง \enquote{Correlations in the Motion of Atoms in Liquid Argon}\autocite{rahman1964} 
    โดย Aneesur Rahman ซึ่งเป็นผู้ที่ใช้ MD ในการคำนวณระบบของ Liquid Argon ซึ่งระบบที่ศึกษาตอนนั้นมี Argon ทั้งหมด 864 อะตอม 
    โดยคำนวณด้วยซุปเปอร์คอมพิวเตอร์  CDC 3600 โดยใช้ Lennard-Jones Potential นอกจากนี้ Aneesur Rahman ได้รับการยอบรับว่า%
    เป็นบิดาแห่งพลวัตเชิงโมเลกุลอีกด้วย (The Father of Molecular Dynamics)

    \item 1971: Aneesur Rahman และ Frank H. Stillinger ได้ตีพิมพ์บทความเรื่อง \enquote{Molecular Dynamics Study of 
    Liquid Water}\autocite{rahman1971} ซึ่งเป็นใช้ MD ในการจำลองระบบโมเลกุลน้ำที่มีจำนวนโมเลกุลคือ 216 โมเลกุล 

    \item 1975: Michael Levitt และ Arich Warshel ได้เผยแพร่บทความวิจัยเรื่อง \enquote{Computer Simulation of Protein 
    Folding}\autocite{levitt1975} ซึ่งเป็นครั้งแรกที่มีการนำเทคนิค MD มาใช้ในการจำลองการพับของโปรตีนโดยเป็นการศึกษาการพับของ 
    Bovine Pancreatic Trypsin Inhibitor (BPTI) จากโครงสร้างที่เป็นแบบสายเปิด

    \item 1979: David A. Case และ Martin Karplus ได้จำลองโปรตีนที่มีลิแกนด์เป็นโมเลกุลที่เข้าไปจับกับโปรแกรมด้วยเป็นครั้งแรก 
    โดยได้ตีพิมพ์งานวิจัยเรื่อง \enquote{Dynamics of ligand binding to heme protein}\autocite{case1979}

    \item 1980s: ในช่วงต้น ๆ ทศวรรษ 1980 นั้นเป็นช่วงที่มีการศึกษาชีวโมเลกุลด้วยการจำลอง MD เป็นจำนวนมาก รวมไปถึงมีการคำนวณ 
    Free Energy ด้วย

    \item 1985: Roberto Car Michele Parrinello ได้พัฒนาเทคนิค Car-Parrinello Molecular Dynamics (CPMD) ซึ่งเสนอใน%
    บทความเรื่อง \enquote{Unified Approach for Molecular Dynamics and Density-Functional Theory}\autocite{car1985} 
    โดยเป็นการนำเทคนิค Density Functional Theory มารวมกับ Born-Oppenheimer Molecular Dynamics

    \item 1988: Michael Levitt และ Ruth Sharon ได้คำนวณระบบของโปรตีนที่มีโมเลกุลน้ำเป็นตัวทำละลายและนำเสนอในบทความเรื่อง 
    \enquote{Accurate Simulation of Protein Dynamics in Solution}\autocite{levitt1988}

    \item 1990s: ในช่วงต้น ๆ ทศวรรษ 1990 นั้นก็ได้มีการพัฒนาศักย์ (Potential) ที่ใช้ในวิธี MD รวมถึงเทคนิคการเพิ่มประสิทธิภาพใน%
    การสุ่ม (Enhanced Sampling) อย่างต่อเนื่อง
\end{itemize}

%----------------------------------------
\section{อันตรกิริยาระหว่างโมเลกุล}
\idxboth{อันตรกิริยาระหว่างโมเลกุล}{Molecular Interactions}
%----------------------------------------

หัวใจสำคัญของ MD Simulations นั้นก็คืออันตรกิริยาระหว่างโมเลกุลนั่นก็คือ \enquote{แรง (Force)} โดยมีสมการสำคัญ 2 สมการที่ถือได้ว่า%
เป็นสมการหลักของ MD เลยก็ว่าได้ ดังนี้

\begin{equation}
    \label{eq:force_newton}
    m_{i}\bm{\ddot{r}}_{i} = \bm{f}_{i}
\end{equation}

\begin{equation}
    \label{eq:force_der_ener}
    \bm{f}_{i} = -\nabla_{i}V(\bm{r})
\end{equation}

\noindent สมการด้านบนนี้คือสมการการเคลื่อนที่ของนิวตัน (Newtonian Equation of Motion) สำหรับอะตอม $i$ โดยที่เป้าหมายของเรา%
นั้นก็คือการคำนวณแรง $\bm{f}$ ที่กระทำต่ออะตอมซึ่งสามารถคำนวณได้จากพลังงานศักย์ $V(\bm{r})$ นั่นเอง ส่วนเวกเตอร์ $\bm{r}$ นั้น%
ก็คือพิกัดคาร์ทีเซียนของตำแหน่งของอะตอม (นิวเคลียส) ทั้งหมดทุกอะตอมในโมเลกุลซึ่งเป็นพิกัดแบบ 3 มิติ

\begin{equation}
    \bm{r} = (\underbrace{r_{1,x}, r_{1,y}, r_{1,z}}_{\text{อะตอมตัวที่ 1}}, \dots, 
    \underbrace{r_{N,x}, r_{N,y}, r_{N,z}}_{\text{อะตอมตัวที่ $N$}})
\end{equation}

โดยในการจำลอง MD นั้นจะเป็นการแก้สมการที่ \ref{eq:force_newton} และ \ref{eq:force_der_ener} พร้อม ๆ กันไปเป็นสเต็ป ๆ 
ตลอดช่วงระยะเวลาที่ทำการจำลอง โดยระยะห่างระหว่างสเต็ปนั้นเรียกว่า Time Step ($\Delta t$)

%----------------------------------------
\section{ข้อจำกัดของ MD}
%----------------------------------------

วิธี MD นั้นก็เหมือนกับวิธีการจำลองทางคอมพิวเตอร์อื่น ๆ ที่มีข้อจำกัดทั้งในเชิงตัวโมเดลของวิธีเองกับในเชิงทรัพยากรที่ใช้ในการคำนวณ โดยข้อจำกัด%
ของ MD สามารถแบ่งออกได้เป็น 4 ข้อหลัก ๆ ดังนี้

\paragraph{1. Time Scale} สเกลเวลาหรือ Time Scale คือสเกลที่บอกถึงระดับของช่วงเวลาที่ใช้ในการอธิบายปรากฎการณ์หรือพฤติกรรมของโมเลกุล%
หรือระบบที่เราต้องการศึกษา เช่น การสั่นของพันธะโมเลกุลนั้นจะมี Time Scale ในระดับ Femtosecond ดังนั้น Time Scale ที่เหมาะสมสำหรับ%
การกำหนด Time Step นั่นจึงอยู่ที่ประมาณ 1 fs เพราะว่าถ้าหากเรากำหนด Time Step ที่กว้างหรือช้ากว่านี้เช่น 10 fs เราก็จะไม่สามารถติดตาม%
การสั่นของโมเลกุลได้เพราะว่าช่วงระยะเวลาที่ใช้ในการขยับหรือเปลี่ยนตำแหน่งของโครสร้างของโมเลกุลนั้นมากกว่าการสั่นของโมเลกุลหลายเท่า

สำหรับการจำลองเหตุการณ์หรือ Event ในการจำลอง MD นั้นเราควรจะต้องทราบถึงระยะเวลาที่เร็วที่สุดที่เหตุการณ์นั้นสามารถเกิดขึ้นได้ก่อน เช่น 
การพับของโปรตีน (Protein Folding) นั้นจะใช้เวลาประมาณ 1 วินาที ดังนั้นถ้าหากเรากำนดให้ Time Step = 1 fs เราจะต้องทำการจำลอง 
MD ประมาณ $10^{15}$ สเต็ปถึงจะสามารถจำลองการพับของโปรตีนได้ อย่างไรก็ตามในความเป็นจริงนั้นปรากฎการณ์ต่าง ๆ ของโมเลกุลที่เกิดขึ้นนั้น%
มักจะเกิดขึ้นในช่วงเวลาระดับ Microsecond ($\mu s$)

\paragraph{2. Length Scale} สเกลขนาดหรือ Length Scale คือสเกลที่บ่งบอกถึงขนาดของระบบที่ถูกจำลองซึ่ง Length Scale นี้จะแบ่ง%
ตามขนาดของระบบที่ใช้ในการศึกษา ถ้าหากเราต้องการที่จะศึกษาคุณสมบัติของระบบที่มีขนาดใหญ่ Length Scale ก็จะต้องสอดคล้องกับระบบด้วย 
เช่น การจำลองโครงข่ายพอลิเมอร์ (Polymer) เพื่อให้มีความเหมาะสมและมีขนาดใหญ่ของระบบที่ใหญ่มากพอที่จะเป็นตัวแทนของระบบพอลิเมอร์%
ในธรรมชาติจริง ๆ 

\paragraph{3. ความแม่นยำของแรงที่คำนวณได้} หัวใจสำคัญของ MD นั้นก็คือการคำนวณแรงที่เป็นอันตรกิริยาระหว่างอะตอมในโมเลกุล ถ้าหาก%
เราใช้วิธีการคำนวณแรงที่มีความแม่นยำสูงก็จะทำให้เราได้แรงที่มีความถูกต้องมาก แต่วิธีการที่มีความแม่นยำสูงนั้นมักจะต้องแลกมาด้วยการคำนวณที่%
สิ้นเปลือง ดังนั้นเรามักจะทำการ Trade-off หรือชั่งน้ำหนักระหว่างการเลือกวิธีในการคำนวณแรงและความสิ้นเปลืองของวิธีนั้น ๆ เพราะอย่าลืมว่า%
เราต้องคำนวณแรงทุก ๆ สเต็ปของการจำลอง MD 

%----------------------------------------
\section{ขั้นตอนการจำลอง MD}
%----------------------------------------

การจำลอง MD นั้นโดยปกติแล้วประกอบไปด้วยขั้นตอนดังต่อไปนี้

\paragraph{1. เลือกโมเดล}

\paragraph{2. เตรียมโครงสร้างเริ่มต้น}

\paragraph{3. รันการจำลอง MD}

\paragraph{4. วิเคราะห์ผลการจำลอง MD}

\paragraph{5. คำนวณคุณสมบัติอื่น ๆ เพิ่มเติม}

%----------------------------------------
\section{แบบฝึกหัด}
%----------------------------------------


