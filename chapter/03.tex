% LaTeX source for ``Algorithms for Computer Simulation of Molecular Systems''
% Copyright (c) 2023 รังสิมันต์ เกษแก้ว (Rangsiman Ketkaew).

% License: Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)
% https://creativecommons.org/licenses/by-nc-nd/4.0/

\chapter{พลวัตเชิงโมเลกุลแบบแอบ อินิชิโอ}
\label{ch:aimd}

%----------------------------------------
\section{ทำไมต้อง \textit{Ab initio} Molecular Dynamics}
%----------------------------------------

เทคนิคการจำลองแบบ Molecular Dynamics (MD) แบบดั้งเดิมหรือ Classical MD นั้นจะใช้ Potential ที่ได้มาจากการใช้ข้อมูลเชิงการทดลอง 
(Empirical Data) หรือจากการคำนวณ Electronic Structure และหัวใจสำคัญของ MD นั้นก็คือสมการที่ใช้ในการอธิบายอันตรกิริยาระหว่างอะตอม 
(Interatomic Interactions) โดยอันตรกิริยาที่เกิดขึ้นทั้งหมดนั้นเราสามารถแบ่งออกได้เป็นหลาย ๆ ส่วน คือ

\begin{itemize}[topsep=0pt,noitemsep]
    \setlength\itemsep{1em}
    \item Two-Body Contribution
    
    \item Three-Body Contribution
    
    \item Many-Body Contribution
    
    \item Long-Range Interaction
    
    \item Short-Range Interaction
    
    \item เทอมอื่น ๆ
\end{itemize}

จุดเริ่มต้นของเทคนิคการจำลองทางเคมีคอมพิวเตอร์แบบใหม่ที่เกิดขึ้นมาจากการนำวิธี MD และ Electronic Structure มารวมกันนั้นเรียกว่า 
\textit{ab initio} Molecular Dynamics (AIMD) ซึ่งอาจจะมีชื่อเรียกอื่น ๆ ที่เราอาจจะคุ้นเคยกันมาบ้าง เช่น 

\begin{itemize}[topsep=0pt,noitemsep]
    \setlength\itemsep{1em}
    \item Car-Parrinello Molecular Dynamics
    
    \item Hellmann-Feynman Molecular Dynamics
    
    \item First Principles Molecular Dynamics
    
    \item Quantum Chemical Molecular Dynamics
    
    \item On-The-Fly Molecular Dynamics
    
    \item Direct Molecular Dynamics
    
    \item Potential-Free Molecular Dynamics
    
    \item Quantum Molecular Dynamics
\end{itemize}

แต่ไอเดียพื้นฐานที่เป็นหัวใจสำคัญของวิธีการคำนวณแบบ AIMD ทุกวิธีนั้นก็คือการคำนวณแรง (Force) ที่กระทำระหว่างอะตอมโดยการใช้วิธี 
Electronic Structure ในแต่ละ Step ของการคำนวณ MD 

การประยุกต์ใช้วิธี AIMD นั้นกว้างขวางมาก ๆ โดยเฉพาะในด้านวัสดุศาสตร์และเคมี จะเห็นได้จากจำนวนงานบทความงานวิจัยเกี่ยวกับ AIMD 
ที่ได้รับการตีพิมพ์เพิ่มมากขึ้นเรื่อย ๆ ทุกปี ซึ่งจุดเริ่มต้นนั้นก็มาจากเปเปอร์ของ Car และ Parrinello ที่ตีพิมพ์ในปี 1985 นั่นคือ 
\enquote{Uniﬁed Approach for Molecular Dynamics and Density–Functional Theory} ที่ทำให้งานวิจัยทางด้านนี้นั้นได้รับความสนใจ 

อย่างไรก็ตาม ถึงแม้ว่าวิธี AIMD นั้นจะทำให้การคำนวณ MD นั้นมีความแม่นยำเพิ่มมากขึ้น แต่ว่าราคาที่นักคำนวณจะต้องจ่ายก็คือความสิ้นเปลืองในการคำนวณ 
(Computational Cost) ในการนำ MD ไปผสมรวมกับวิธี \textit{ab initio} นั่นก็คือความสัมพันธ์ระหว่าง Length และ Relaxation Time 
ที่เราสามารถรันการคำนวณด้วยแบบจำลอง AIMD นั้นสั้นมาก ๆ เมื่อเทียบกับวิธี MD ทั่วไป (สำหรับระบบโมเลกุลเดียวกัน) ถึงแม้ว่าข้อเสียของวิธี AIMD 
นั้นคือใช้เวลาในการคำนวณที่นานกว่า MD เยอะมาก ๆ แต่ว่าเราก็อย่าลืมไปว่าวิธี AIMD นั้นมีข้อดีอีกหลายข้อเลยที่เราจะไม่พูดถึงก็ไม่ได้ 
ข้อดีอย่างแรกก็คือวิธี AIMD สามารถให้ผลการคำนวณที่สอดคล้องกับ Physical Picture จริง ๆ ของระบบที่เราจำลอง ข้อดีอีกอย่างก็คือวิธี AIMD 
นั้นสามารถช่วยให้เราสามารถจำลองปรากฏการณ์ของระบบโมเลกุลที่ไม่สามารถเกิดขึ้นได้ในการจำลองด้วยวิธี MD

จริง ๆ แล้วก่อนที่จะมีการพัฒนาวิธี AIMD ขึ้นมานั้น ในอดีตก็มีวิธีที่คล้าย ๆ กันเรียกว่า \enquote{Classical Trajectory Calculation} 
ซึ่งมีจุดเริ่มต้นคือคำนวณระบบ Gas Phase ด้วยวิธี MD เพื่อศึกษา \enquote{Global} Potential Energy Surface (PES) 
หรือพื้นผิวพลังงานศักย์ แล้วก็ตามด้วยการคำนวณ Dynamical Evolution ของระบบโดยการใช้ Classical Mechanics หรือ Quantum Mechanics 
หรือ Semi/Quasiclassical Approximations ซึ่งในกรณีที่ใช้วิธี Classical Mechanics ในการอธิบาย Dynamics ของระบบโมเลกุลนั้น%
มีอุปสรรคก็คือขนาดของระบบ กล่าวคือ ยิ่งระบบมีขนาดใหญ่ การใช้วิธี Classical Mechanics นั้นก็จะยิ่งทำได้ยาก (สิ้นเปลืองการคำนวณ) 
นั่นก็เพราะว่าระบบที่มี $N$ อะตอมนั้นก็จะมีจำนวนดีกรีของความอิสระ (Degree of Freedom) เท่ากับ $3N - 6$ ที่จะเป็นตัวกำหนดขนาดของ PES 
แล้วถ้าหากว่าเราใช้จำนวน Discretization Points เช่น 10 Points ต่อ Coordinate นั่นคือเรามีจำนวนการคำนวณ Electronic Structure 
ที่จะต้องคำนวณเท่ากับ $10^{3N - 6}$ เพื่อที่ทำการ Mapping เพื่อให้ได้ Global PES ของระบบโมเลกุลของเราออกมา 
ดังนั้นความสิ้นเปลืองของวิธีแรกนั้นเท่ากับ $10^{N}$ ซึ่งเพิ่มตามขนาดของระบบ ซึ่งเราเรียกปัญหานี้ว่า \enquote{Dimensionality Bottleneck}

คำถามคือ \enquote{ถ้าหากอยากจะรู้ว่า AIMD สิ้นเปลืองแค่ไหน เราจะต้องคำนึงถึงอะไรบ้าง?} ในการตอบคำถามนี้ผมขอเริ่มด้วยการยกตัวอย่างต่อไปนี้ 
สมมติว่าเรามี Trajectory ของการคำนวณ MD ที่มีจำนวนทั้งหมด $10^{M}$ Steps (ก็คือมีทั้งหมด $10^{M}$ Configurations) 
นั่นคือจะต้องมีการคำนวณ Electronic Structure ทั้งหมด $10^{M}$ ครั้ง ถ้าหากว่ามีจำนวน Independent Trajectory ทั้งหมด $10^{n}$ 
Trajectories ที่จำเป็นที่จะต้องคำนวณเพื่อทำการเฉลี่ย Initial Conditions ดังนั้นจึงมีการคำนวณ AIMD ทั้งหมด $10^{M + n}$ 
การคำนวณที่จะต้องทำการรัน ลำดับสุดท้าย ถ้าหากว่าเราจะต้องทำการคำนวณ Single-Point Electronic Structure เพื่อคำนวณ Global PES 
และแต่ละการคำนวณของ AIMD นั้นใช้เวลา CPU Time เท่ากัน จากข้อมูลทั้งหมดที่เราอ้างขึ้นมาตามสถานการณ์ความเป็นจริงนั้น เราจะสรุปได้ว่าการใช้ 
AIMD ในการคำนวณ Global PES นั้นจะมีความสิ้นเปลืองอยู่ที่ประมาณ $10^{3N-6-M-n}$ ประเด็นสำคัญก็คือว่า สำหรับระบบที่มี $M$ และ $n$ 
คงที่และไม่ขึ้นกับ $N$ นั้น การคำนวณ AIMD จะมี Advantage เป็นแบบ \enquote{On-The-Fly} ซึ่งจะมีความสิ้นเปลืองของวิธีคือ $10^{N}$ 
เพิ่มขึ้นตามขนาดของระบบ

อย่างไรก็ตาม ความสิ้นเปลืองของวิธี AIMD ที่ประมาณ $10^{N}$ นั้นก็ยังเยอะอยู่ดี ดังนั้นจึงได้มีการพัฒนาเทคนิคต่าง ๆ ขึ้นมาเพื่อใช้ในการลดจำนวน 
Degrees of Freedom แต่ว่าเทคนิคเหล่านั้นก็เป็นการใช้ Approximations (การประมาณ) เสียส่วนใหญ่ นั่นจึงทำให้ความถูกต้องของ AIMD นั้นลดลงด้วย 

ในบทนี้ผมจะพาผู้อ่านทุกท่านไปทำความรู้จักกับวิธี AIMD ซึ่งเป็นภาพรวมกว้าง ๆ โดยเราจะเริ่มต้นกันด้วยสมการ Schr\"{o}dinger แล้วก็จะมีการพูดถึง 
Classical MD, Ehrenfest MD, Born-Oppenheimer, และ Car-Parrinello MD ซึ่งเป็นวิธีที่ได้มาจากวิธี Time-Dependent Mean-Field 
Approach ซึ่งได้หลังจากการที่เราทำการแยก Degrees of Freedom ของนิวเคลียสกับอิเล็กตรอนออกจากกัน นอกจากนี้ยังมีอีกหนึ่งเรื่องสำคัญที่ผู้อ่าน%
จะได้ศึกษานั่นคือการคำนวณแรง (Force) ของวิธีต่าง ๆ ด้วย ซึ่งหนึ่งในวิธีที่ถูกนำมาใช้ในการคำนวณ Force ที่ได้รับความนิยมเป็นอย่างมากนั่นคือ
Density Functional Theory (DFT) ดังนั้นเราจึงสามารถเรียกวิธีที่ใช้ในการจำลอง AIMD ที่มีความถูกต้องของการคำนวณ Electronic Structure 
ในแต่ละ Step ของ MD ได้ว่า Density Functional Theory-based Molecular Dynamics หรือ DFT-MD
 
%----------------------------------------
\section{ประเภทของ \textit{Ab initio} Molecular Dynamics}
%----------------------------------------

เราสามารถแบ่งประเภทของ AIMD ได้โดยแบ่งตามวิธีการที่เราใช้ในการรวมการคำนวณโครงสร้างเชิงอิเล็กทรอนิกส์กับการจำลองพลวัตโมเลกุลเข้าด้วยกัน 
โดยเราสามารถแบ่งออกได้เป็น 3 วิธี ดังนี้ 

\begin{enumerate}[topsep=0pt,noitemsep]
    \setlength\itemsep{1em}
    \item Born-Oppenheimer Molecular Dynamics
    
    \item Ehrenfest Molecular Dynamics
    
    \item Car-Parrinello Molecular Dynamics
\end{enumerate}

%----------------------------------------
\section{พลวัตเชิงโมเลกุลแบบบอร์น-ออปเพนไฮเมอร์}
%----------------------------------------

%----------------------------------------
\section{พลวัตเชิงโมเลกุลแบบเออเรนเฟสต์}
%----------------------------------------

%----------------------------------------
\section{พลวัตเชิงโมเลกุลแบบคาร์-พาร์ริเนลโล}
%----------------------------------------

%----------------------------------------
\section{วิธีการเลือกใช้เทคนิค AIMD}
%----------------------------------------

%----------------------------------------
\section{การสุ่มตัวอย่างแบบมีประสิทธิภาพ}
%----------------------------------------

การสุ่มตัวอย่างแบบมีประสิทธิภาพ (Enhanced Sampling)

%----------------------------------------
\subsection{การคำนวณพลังงานอิสระ}
%----------------------------------------

%----------------------------------------
\subsection{เทคนิคเมตาไดนามิกส์}
%----------------------------------------

%----------------------------------------
\section{แบบฝึกหัด}
%----------------------------------------
